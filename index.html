<!DOCTYPE html>
<html>
    <head>
        <style>

            h1 {
                font-family: cursive;
                text-align: center;
            }
            table {
                width:80%;
                overflow-wrap: break-word;

                margin: auto;
                padding: 20px;
                border-radius: 10px;
                background-color: #ebebeb;

                font-family: Arial, Helvetica, sans-serif;
            }
            td {
                padding: 10px;
                border-radius: 5px;
            }
            tr:nth-child(even) {
                background-color:rgb(209, 209, 209);
            }
            tr:nth-child(odd) {
                background-color:rgb(159, 159, 159);
            }
            nav {
                width:80%;
                text-align: center;
                margin-left: auto;
                margin-right: auto;
                margin-bottom: 20px;
                padding: 20px;
                border-radius: 5px;
                border: 3px black solid;
            }
            label {
                padding-right: 8%;
            }
            
            @media (max-width: 480px) {
                
                table {
                    width:100%;   
                }

                table,
                table thead,
                table tbody,
                table th,
                table td,
                table tr {
                    display: block;
                }
            }
           

           
        /* add a label around the table so that once a category is clicked the nav is hidden, table items are hidden, specific item is shown*/ 
        </style>
    </head>
    <body>
    <header>
        <h1>Your Favorite Web Store</h1>
    </header>
    <nav>
        
    </nav>
    <main>
        <div id="itemView">
            <table>
                <thead>
                    <tr>
                        <th colspan="2">item</th>
                        <th>description</th>
                        <th>price</th></thead>
                    </tr>
                <tbody id="table">
                    <tr>
                        <td rowspan = 4 colspan = 4 style="text-align:center">Select a category above</td>
                    </tr>
                </tbody>
            </table>
        </div>

        
        <div id="itemView">
            <!--- item view here--->
        </div>
    </main>
    <footer></footer>
    <script>
        /* turn api data elements into objects, use a for loop to pull objects out for the main table 
        */ 

        let url = `https://6245f389e3450d61b0f926c1.mockapi.io/api/v1/`;
        let endpoint1 = "categories";
        //let endpoint2 = `categories/${category}/items`;

        makeNav(); 

        async function getApiData(targetUrl) {
            try {
                let connection = await fetch(targetUrl);
                return await connection.json();
            } catch (error){
                console.log(error);
            }
        }


        /*async function makeTable(category) {
            let endpoint2 = `categories/${category}/items`;
            let results = await getApiData(url + endpoint2);
            let html = ``;

            results.forEach(item => {
                htmlSegment = `<tr>`
                    +`<td><img src=${item.image[1]} height="100" width="200"></td>`
                    + `<td>${item.itemName}</td>`
                    + `<td>${item.itemBrief}</td>`
                    + `<td>${item.price}</td>`
                    + `</tr>`;
                html += htmlSegment;
            });

            document.getElementById("table").innerHTML = html;

           // let categoryContainer = document.getElementById("table");
            //categoryContainer.innerHTML = html;
        }
        */

        async function makeTable(category) {
            console.log('got makeTable()');
            let endpoint2 = `categories/${category}/items`;
            let object = await getApiData(url + endpoint2);

            let htmlOutput = "";
            for (let x = 0; x < object.items.length; x++) {
                htmlOutput += `<tr>`
                    +`<td><img src=${object.items[x].image[1]} height="90" width="160"></td>`
                    + `<td>${object.items[x].itemName}</td>`
                    + `<td>${object.items[x].itemBrief}</td>`
                    + `<td>$${object.items[x].price}</td>`
                    + `</tr>`
            }

            document.getElementById("table").innerHTML = htmlOutput;
        }

        async function makeNav() {
            console.log('got makeNav()');
            let results = await getApiData(url + endpoint1);
            let html = `<span id="categories">Filter: </span>`;

            results.forEach(item => {
                htmlSegment = `<label for=cat${item.id}"><input type="radio" name="selection" id="cat${item.id}" value = "${item.id}" onclick = "makeTable(${item.id})">${item.name}</label>`;
                html += htmlSegment;
            });

            let categoryContainer = document.querySelector('nav');
            categoryContainer.innerHTML = html;

        }

        function hideItem() {
            console.log('got hideItem()');
            document.getElementById("itemView").style.display="none";
            document.getElementById("categories").style.display="block";
            document.getElementById("listView").style.display="block";
        }

        function showItem() {
            console.log('got showItem()');
            document.getElementById("itemView").style.display="block";
            document.getElementById("categories").style.display="none";
            document.getElementById("listView").style.display="none";
        }

    </script>
    </body>
</html>